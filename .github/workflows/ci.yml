name: Java CI with Gradle

# いつ実行するか？
# mainブランチへのpush、またはプルリクエストがあった時に動く
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    # Linux環境（Ubuntu）で動かす
    runs-on: ubuntu-latest

    steps:
      # 1. リポジトリのコードをチェックアウト（持ってくる）
      - uses: actions/checkout@v4

      # 2. Java 21 の環境をセットアップする
      - name: Set up JDK 21
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'

      # 3. Gradleのキャッシュ設定（2回目以降を速くするため）
      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v3

      # 4. テストを実行する（ここが一番大事！）
      - name: Run Tests with Gradle
        run: ./gradlew test

    # (オプション) テスト結果のレポートを保存する場合
    # - name: Publish Test Report
    #   if: always()
    #   uses: mikepenz/action-junit-report@v4
    #   with:
    #     report_paths: '**/build/test-results/test/TEST-*.xml'